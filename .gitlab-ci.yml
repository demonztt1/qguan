# docker镜像
image: node:latest
# 设置变量
variables:
    # 镜像启动后的容器名
    CONTAINER_NAME: gitlab-ci-cd
    REGISTRY_IMAGE_TAG: gitlab-ci-cd:master
    # 镜像启动后的容器名
    CONTAINER_NAME: gitlab-ci-cd
stages:
   - build
   - test
   - deploy

test:
    stage: test
    script:
        # 停止并删除正在使用当前镜像的容器
        - ping 127.0.0.1

    only:
      - master
    tags:
      - ci-cd

test:
  stage: test
  script:
    # 本地启动容器进行测试
    - ping 127.0.0.1
  when: on_success
  only:
    - master
  tags:
    - ci-cd

deploy:
  stage: deploy
  script:
    - ping 127.0.0.1